# Предсказание вероятности повторных покупок в интернет-магазине
## Описание проекта  
Интернет-магазин собирает историю покупателей, проводит рассылки предложений и планирует будущие продажи. Для оптимизации процессов надо выделить пользователей, которые готовы совершить покупку в ближайшее время.
### Цель  
Предсказать вероятность покупки (т.е., факт возврата клиента) в течение 90 дней.  
### Задачи  
- Изучить данные
- Разработать полезные признаки
- Создать модель для классификации пользователей
- Улучшить модель и максимизировать метрику roc_auc
- Выполнить тестирование
## Описание данных
<u>Файл `apparel-purchases.csv`<u> 

История покупок

Содержит информацию о покупках клиентов по дням и по товарам. В каждой записи покупка определенного товара, его цена, количество штук.

В таблице есть списки идентификаторов, к каким категориям относится товар. Часто это вложенные категории (например автотовары-аксессуары-освежители), но также может включать в начале списка маркер распродажи или маркер женщинам/мужчинам.

Нумерация категорий сквозная для всех уровней, то есть 44 на второй позиции списка или на третьей – это одна и та же категория. Иногда дерево категорий обновляется, поэтому могут меняться вложенности, например ['4', '28', '44', '1594'] или ['4', '44', '1594'].

● `client_id` - идентификатор пользователя  
● `quantity` - количество товаров в заказе  
● `price` - цена товара  
● `category_ids` - вложенные категории, к которым отнсится товар  
● `date` - дата покупки  
● `message_id` - идентификатор сообщения из рассылки  

<u>Файл `apparel-messages.csv`<u>  

История рекламных рассылок  
Содержит рассылки, которые были отправлены клиентам из таблицы покупок.  

● `bulk_campaign_id` - идентификатор рассылки  
● `client_id` - идентификатор клиента  
● `message_id` - идентификатор сообщения  
● `event` - действие с сообщением (отправлено, открыто, покупка…)  
● `channel` - канал рассылки  
● `date` - дата действия  
● `created_at` - дата-время полностью  

<u>Файл `apparel-target_binary.csv`<u>  

Совершит ли клиент покупку в течение следующих 90 дней  

● `client_id` - идентификатор клиента  
● `target` - клиент совершил покупку в целевом периоде - целевой признак  
## Краткое резюме выполненной работы
- загрузка и изучение данных  
- проведение предобработки и исследовательского анализа  
- разработка новых признаков  
- проверка на мультиколлинеарность
- окончательный отбор признаков  
- создание и обучение моделей для классификации пользователей
- подбор гиперпараметров  
- улучшение модели и метрики ROC-AUC
- тестирование
- исследование значимости признаков
## Полученные результаты
Лучшей моделью была выбрана:

{'models__n_estimators': 230, 'models__min_samples_split': 3, 'models__min_samples_leaf': 2, 'models__max_depth': 10, 'models__class_weight': 'balanced_subsample', 'models': RandomForestClassifier(random_state=42)} 

которая показала метрику ROC-AUC 0.7404 на тренировочной выборке.

Наиболее важными с точки зрения модели признаками оказались следующие (в порядке уменьшения важности): 

- `purchase_period` (период, в течение которого клиент совершал покупки)
- `click` (количество сделанных "кликов")
- `mobile_push`(количество полученных push-уведомлений)
- `open` (количество открытых сообщений)
- `days_since_last_purch` (количество дней с момента последней покупки).
  
Таким образом, важно обратить внимание на следующие показатели:

- длительность периода, в течение которого клиент совершал покупки
- сколько раз клиент кликнул на push-уведомление
- сколько push-уведомлений было открыто клиентом
- количество покупок по email-рассылке
- сколько раз клиент отписался от email-рассылки
- сумма покупок клиента
- когда была совершена последняя покупка
    
